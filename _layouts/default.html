<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}</title>
  <link rel="stylesheet" href="{{ '/assets/style/site.css' | relative_url }}">
  {% if page.print_friendly %}
  <link rel="stylesheet" href="{{ '/assets/style/print.css' | relative_url }}">
  {% endif %}
</head>
<body>
  <header class="site-header">
    <div class="header-content">
      <a href="{{ site.url }}" class="site-logo">
        <img src="{{ '/assets/images/logo-transparent.png' | relative_url }}" alt="Lansing Tech Studio" class="logo-img">
        <span class="site-title">{{ site.parent_title }}</span>
      </a>
      <button class="nav-toggle" aria-label="Toggle navigation">
        <span class="hamburger"></span>
      </button>
    </div>
  </header>

  <div class="page-wrapper">
    <nav class="sidebar" id="sidebar">
      {% include nav.html %}
    </nav>

    <main class="main-content">
      {% if page.workshop %}
      {% assign url_parts = page.url | split: '/' %}
      {% assign workshop_slug = url_parts[1] %}
      {% assign workshop_url = '/' | append: workshop_slug | append: '/' | relative_url %}
      <nav class="breadcrumb" aria-label="Breadcrumb">
        <a href="{{ '/' | relative_url }}">Workshops Home</a>
        <span class="separator">›</span>
        <a href="{{ workshop_url }}">{{ page.workshop }}</a>
        {% if page.section %}
        <span class="separator">›</span>
        <span>{{ page.section }}</span>
        {% endif %}
      </nav>
      {% endif %}

      <article class="content">
        {{ content }}
      </article>

      {% if page.workshop %}
      <footer class="page-footer">
        <a href="{{ workshop_url }}" class="back-link">← Back to {{ page.workshop }}</a>
      </footer>
      {% endif %}
    </main>
  </div>

  <footer class="site-footer">
    <p>&copy; {{ 'now' | date: "%Y" }} Lansing Tech Studio. All rights reserved.</p>
    <p>
      <a href="https://github.com/Lansing-Tech-Studio/workshops">View on GitHub</a>
    </p>
  </footer>

  <script>
    // Mobile navigation toggle
    document.querySelector('.nav-toggle').addEventListener('click', function() {
      document.getElementById('sidebar').classList.toggle('open');
      this.classList.toggle('active');
    });

    // Collapsible subnav toggle
    document.querySelectorAll('.nav-toggle-btn').forEach(function(btn) {
      btn.addEventListener('click', function(e) {
        e.preventDefault();
        const navItem = this.closest('.nav-item');
        const isExpanded = navItem.classList.toggle('expanded');
        this.setAttribute('aria-expanded', isExpanded);
      });
    });

    // Auto-expand nav items that contain the current page or are active
    document.querySelectorAll('.nav-item.has-subnav').forEach(function(navItem) {
      const subnav = navItem.querySelector('.nav-subnav');
      const isActive = navItem.classList.contains('active') || (subnav && subnav.querySelector('.active'));
      if (isActive) {
        navItem.classList.add('expanded');
        const btn = navItem.querySelector('.nav-toggle-btn');
        if (btn) btn.setAttribute('aria-expanded', 'true');
      }
    });
  </script>
</body>
</html>
